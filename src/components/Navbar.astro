<!-- ---
import imageUrl from "../assets/logo_sos-removebg-preview.webp";
---
<style>
  .backdrop-blur-glass {
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }

  .transition-navbar {
    transition: all 0.3s ease-in-out;
  }
</style>

<nav id="navbar" class={`fixed top-0 left-0 right-0 z-50 w-full transition-navbar ${['/', '/about'].includes(Astro.url.pathname) ? 'bg-transparent text-white' : 'bg-white text-black shadow-md'}`}>
  <div class="max-w-screen-3xl flex flex-wrap items-center justify-between mx-auto py-2 px-[120px]">
    <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse">
      <img src={imageUrl.src} class="h-[60px] md:h-[80px]" alt="Logo" />
    </a>
    <button id="mobile-menu-button" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 transition">
      <span class="sr-only">Open main menu</span>
      <svg class="w-5 h-5" fill="none" viewBox="0 0 17 14" xmlns="http://www.w3.org/2000/svg">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
      </svg>
    </button>
    <div class="hidden w-full md:block md:w-auto" id="navbar-default">
      <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 md:flex-row md:space-x-8 md:mt-0 text-sm">
        <li><a href="/about" class="block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600 transition">ABOUT</a></li>
        <li><a href="/research" class="block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600 transition">RESEARCH</a></li>
        <li><a href="/programs" class="block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600 transition">PROGRAM OFFERED</a></li>
        <li><a href="/outreach" class="block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600 transition">OUTREACH</a></li>
        <li><a href="/knowledgehub" class="block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600 transition">KNOWLEDGE HUB</a></li>
        <li><a href="#" class="block py-2 px-3 md:p-0"><i class="fas fa-search"></i></a></li>
      </ul>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const navbar = document.getElementById('navbar');
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('navbar-default');

    // Toggle mobile menu
    if (button && menu) {
      button.addEventListener('click', function () {
        menu.classList.toggle('hidden');
        menu.classList.toggle('block');
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        button.setAttribute('aria-expanded', String(!isExpanded));
      });
    }

    // Handle scroll and background switch
    function updateNavbar() {
      const currentScrollY = window.scrollY;

      if (navbar) {
        if (currentScrollY > 50) {
          navbar.classList.remove('bg-transparent', 'text-white');
          navbar.classList.add('bg-white', 'text-black', 'shadow-md');
        } else {
          if (window.location.pathname === '/' || window.location.pathname === '/about') {
            navbar.classList.add('bg-transparent', 'text-white');
            navbar.classList.remove('bg-white', 'text-black', 'shadow-md');
          }
        }
      }
    }

    // Throttle scroll performance
    let ticking = false;
    function requestTick() {
      if (!ticking) {
        requestAnimationFrame(updateNavbar);
        ticking = true;
        setTimeout(() => ticking = false, 16);
      }
    }

    window.addEventListener('scroll', requestTick, { passive: true });
    updateNavbar();
  });
</script> -->

---
import imageUrl from "../assets/logo_sos-removebg-preview.webp";
---

<style>
  .backdrop-blur-glass {
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }

  .transition-navbar {
    transition: all 0.3s ease-in-out;
  }

  .navbar-link {
    transition: color 0.3s ease;
  }
</style>

<nav id="navbar" class={`fixed top-0 left-0 right-0 z-50 w-full transition-navbar ${['/', '/about'].includes(Astro.url.pathname) ? 'bg-transparent text-white' : 'bg-white text-black shadow-md'}`}>
  <div class="max-w-screen-3xl flex flex-wrap items-center justify-between mx-auto py-2 px-[120px]">
    <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse">
      <img src={imageUrl.src} class="h-[60px] md:h-[80px]" alt="Logo" />
    </a>
    <button id="mobile-menu-button" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 transition">
      <span class="sr-only">Open main menu</span>
      <svg class="w-5 h-5" fill="none" viewBox="0 0 17 14" xmlns="http://www.w3.org/2000/svg">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
      </svg>
    </button>
    <div class="hidden w-full md:block md:w-auto" id="navbar-default">
      <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 md:flex-row md:space-x-8 md:mt-0 text-sm">
        <li><a href="/about" class="navbar-link block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600">ABOUT</a></li>
        <li><a href="/research" class="navbar-link block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600">RESEARCH</a></li>
        <li><a href="/programs" class="navbar-link block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600">PROGRAM OFFERED</a></li>
        <li><a href="/outreach" class="navbar-link block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600">OUTREACH</a></li>
        <li><a href="/knowledgehub" class="navbar-link block py-2 px-3 md:p-0 font-semibold text-[16px] hover:text-blue-600">KNOWLEDGE HUB</a></li>
        <li><a href="#" class="navbar-link block py-2 px-3 md:p-0"><i class="fas fa-search"></i></a></li>
      </ul>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const navbar = document.getElementById('navbar');
    const links = document.querySelectorAll('.navbar-link');
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('navbar-default');

    if (button && menu) {
      button.addEventListener('click', function () {
        menu.classList.toggle('hidden');
        menu.classList.toggle('block');
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        button.setAttribute('aria-expanded', String(!isExpanded));
      });
    }

    function updateNavbar() {
      const currentScrollY = window.scrollY;

      if (navbar) {
        if (currentScrollY > 50) {
          navbar.classList.remove('bg-transparent', 'text-white');
          navbar.classList.add('bg-white', 'text-black', 'shadow-md');
          links.forEach(link => {
            link.classList.remove('text-white');
            link.classList.add('text-black');
          });
        } else {
          if (window.location.pathname === '/' || window.location.pathname === '/about') {
            navbar.classList.add('bg-transparent', 'text-white');
            navbar.classList.remove('bg-white', 'text-black', 'shadow-md');
            links.forEach(link => {
              link.classList.remove('text-black');
              link.classList.add('text-white');
            });
          }
        }
      }
    }

    let ticking = false;
    function requestTick() {
      if (!ticking) {
        requestAnimationFrame(updateNavbar);
        ticking = true;
        setTimeout(() => ticking = false, 16);
      }
    }

    window.addEventListener('scroll', requestTick, { passive: true });
    updateNavbar();
  });
</script>
